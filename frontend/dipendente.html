<!doctype html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Area Dipendente - Gestione Presenze</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .gradient-bg {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      .card-hover {
        transition: all 0.3s ease;
      }
      .card-hover:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      }
      .tab-content {
        display: none;
      }
      .tab-content.active {
        display: block;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-6">
          <div class="flex items-center">
            <i class="fas fa-user text-2xl mr-3"></i>
            <h1 class="text-2xl font-bold">Area Dipendente</h1>
          </div>
          <div class="flex items-center space-x-4">
            <span id="currentTime" class="text-sm"></span>
            <button
              onclick="logout()"
              class="bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg transition-colors"
            >
              <i class="fas fa-sign-out-alt mr-2"></i>Logout
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white shadow-sm border-b">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex space-x-8">
          <button
            onclick="showTab('dashboard')"
            class="tab-button active py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium"
          >
            <i class="fas fa-chart-line mr-2"></i>Dashboard
          </button>
          <button
            onclick="showTab('attendance')"
            class="tab-button py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium"
          >
            <i class="fas fa-clock mr-2"></i>Presenze
          </button>
          <button
            onclick="showTab('requests')"
            class="tab-button py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium"
          >
            <i class="fas fa-file-alt mr-2"></i>Richieste
          </button>
          <button
            onclick="showTab('profile')"
            class="tab-button py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium"
          >
            <i class="fas fa-user-circle mr-2"></i>Profilo
          </button>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Dashboard Tab -->
      <div id="dashboard" class="tab-content active">
        <!-- Welcome Section -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-8">
          <div class="flex items-center justify-between">
            <div>
              <h2 class="text-2xl font-bold text-gray-900" id="welcomeMessage">
                Benvenuto!
              </h2>
              <p class="text-gray-600 mt-1">
                Gestisci le tue presenze e richieste
              </p>
            </div>
            <div class="text-right">
              <p class="text-sm text-gray-500">Oggi</p>
              <p
                class="text-lg font-semibold text-gray-900"
                id="currentDate"
              ></p>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
          <div class="bg-white rounded-xl shadow-md p-6 card-hover">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">
              <i class="fas fa-clock mr-2 text-blue-600"></i>
              Stato Presenza
            </h3>
            <div id="attendanceStatus" class="text-center py-4">
              <div class="animate-pulse">
                <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
                <div class="h-4 bg-gray-200 rounded w-1/2 mx-auto"></div>
              </div>
            </div>
            <div class="flex space-x-3 mt-4">
              <button
                onclick="registraEntrata()"
                class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition-colors"
              >
                <i class="fas fa-sign-in-alt mr-2"></i>Entrata
              </button>
              <button
                onclick="registraUscita()"
                class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg transition-colors"
              >
                <i class="fas fa-sign-out-alt mr-2"></i>Uscita
              </button>
            </div>
          </div>

          <div class="bg-white rounded-xl shadow-md p-6 card-hover">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">
              <i class="fas fa-chart-bar mr-2 text-green-600"></i>
              Statistiche Mensili
            </h3>
            <div id="monthlyStats" class="space-y-3">
              <div class="flex justify-between items-center">
                <span class="text-gray-600">Giorni di presenza:</span>
                <span id="presenceDays" class="font-semibold text-green-600"
                  >-</span
                >
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600">Ore totali:</span>
                <span id="totalHours" class="font-semibold text-blue-600"
                  >-</span
                >
              </div>
              <div class="flex justify-between items-center">
                <span class="text-gray-600">Media ore/giorno:</span>
                <span id="avgHours" class="font-semibold text-purple-600"
                  >-</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="bg-white rounded-xl shadow-md p-6">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">
            <i class="fas fa-history mr-2 text-purple-600"></i>
            Attivit√† Recenti
          </h3>
          <div id="recentActivity" class="space-y-3">
            <div class="animate-pulse">
              <div class="h-4 bg-gray-200 rounded w-3/4 mb-2"></div>
              <div class="h-4 bg-gray-200 rounded w-1/2"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Attendance Tab -->
      <div id="attendance" class="tab-content">
        <div class="bg-white rounded-xl shadow-md p-6">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-gray-800">
              <i class="fas fa-clock mr-2 text-blue-600"></i>
              Storico Presenze
            </h2>
            <div class="flex space-x-2">
              <input
                type="month"
                id="attendanceMonth"
                onchange="loadAttendanceHistory()"
                class="border border-gray-300 rounded-lg px-3 py-2"
              />
            </div>
          </div>
          <div id="attendanceHistory" class="space-y-3">
            <!-- Attendance history will be loaded here -->
          </div>
        </div>
      </div>

      <!-- Requests Tab -->
      <div id="requests" class="tab-content">
        <div class="bg-white rounded-xl shadow-md p-6">
          <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-gray-800">
              <i class="fas fa-file-alt mr-2 text-green-600"></i>
              Gestione Richieste
            </h2>
            <button
              onclick="showCreateRequestModal()"
              class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              <i class="fas fa-plus mr-2"></i>Nuova Richiesta
            </button>
          </div>
          <div id="requestsList" class="space-y-4">
            <!-- Requests will be loaded here -->
          </div>
        </div>
      </div>

      <!-- Profile Tab -->
      <div id="profile" class="tab-content">
        <div class="bg-white rounded-xl shadow-md p-6">
          <h2 class="text-xl font-semibold text-gray-800 mb-6">
            <i class="fas fa-user-circle mr-2 text-purple-600"></i>
            Profilo Personale
          </h2>
          <div id="profileInfo" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Profile information will be loaded here -->
          </div>
        </div>
      </div>
    </main>

    <!-- Create Request Modal -->
    <div
      id="createRequestModal"
      class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50"
    >
      <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-xl shadow-xl max-w-md w-full p-6">
          <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-semibold text-gray-900">Nuova Richiesta</h3>
            <button
              onclick="hideCreateRequestModal()"
              class="text-gray-400 hover:text-gray-600"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <form id="createRequestForm" class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Tipo Richiesta</label
              >
              <select
                id="requestType"
                required
                class="border border-gray-300 rounded-lg px-3 py-2 w-full"
              >
                <option value="">Seleziona tipo</option>
                <option value="Ferie">Ferie</option>
                <option value="Permesso">Permesso</option>
                <option value="Malattia">Malattia</option>
                <option value="Smart Working">Smart Working</option>
              </select>
            </div>
            <div class="grid grid-cols-2 gap-3">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >Data Inizio</label
                >
                <input
                  type="date"
                  id="requestStartDate"
                  required
                  class="border border-gray-300 rounded-lg px-3 py-2 w-full"
                />
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1"
                  >Data Fine</label
                >
                <input
                  type="date"
                  id="requestEndDate"
                  required
                  class="border border-gray-300 rounded-lg px-3 py-2 w-full"
                />
              </div>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1"
                >Motivo</label
              >
              <textarea
                id="requestReason"
                rows="3"
                class="border border-gray-300 rounded-lg px-3 py-2 w-full"
                placeholder="Descrivi il motivo della richiesta..."
              ></textarea>
            </div>
            <div class="flex space-x-3">
              <button
                type="submit"
                class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors flex-1"
              >
                Invia Richiesta
              </button>
              <button
                type="button"
                onclick="hideCreateRequestModal()"
                class="bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-lg transition-colors flex-1"
              >
                Annulla
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div
      id="toast"
      class="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50"
    >
      <div class="flex items-center">
        <i class="fas fa-check-circle mr-2"></i>
        <span id="toastMessage"></span>
      </div>
    </div>

    <script src="js/dipendente.js"></script>
    <script>
      function logout() {
        localStorage.removeItem("user");
        window.location.href = "login.html";
      }

      function updateTime() {
        const now = new Date();
        document.getElementById("currentTime").textContent =
          now.toLocaleString("it-IT");
        document.getElementById("currentDate").textContent =
          now.toLocaleDateString("it-IT", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });
      }

      setInterval(updateTime, 1000);
      updateTime();
    </script>
  </body>
</html>
